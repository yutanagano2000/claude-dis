# Doc Generator Skill

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆã‚¹ã‚­ãƒ« - Repomix + Codex + Gemini çµ±åˆãƒ•ãƒ­ãƒ¼

## Trigger

ä»¥ä¸‹ã®ãƒ•ãƒ¬ãƒ¼ã‚ºã§èµ·å‹•:
- `/doc-generator`
- ã€Œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã€ã€Œè¨­è¨ˆæ›¸ä½œæˆã€ã€Œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã€

## æ¦‚è¦

ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ:
- åŸºæœ¬è¨­è¨ˆæ›¸ï¼ˆã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€æ©Ÿèƒ½ä¸€è¦§ï¼‰
- è©³ç´°è¨­è¨ˆæ›¸ï¼ˆã‚¯ãƒ©ã‚¹å›³ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ï¼‰
- APIä»•æ§˜æ›¸ï¼ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹å®šç¾©ï¼‰

---

## å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

```
Phase 1: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåé›†ï¼ˆRepomixï¼‰
    â†“
Phase 2: é™çš„åˆ†æï¼ˆCodexï¼‰
    â†“
Phase 3: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆï¼ˆGeminiï¼‰
    â†“
Phase 4: æ¤œè¨¼ãƒ»æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼ˆCodexï¼‰
    â†“
Phase 5: å‡ºåŠ›ãƒ»ä¿å­˜
```

---

## Phase 1: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåé›†

### 1.1 Repomixã§ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹é›†ç´„

```bash
# åŸºæœ¬å®Ÿè¡Œ
repomix --output .repomix-output.md

# ç‰¹å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿
repomix --include "src/**" --output .repomix-output.md

# é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ä»˜ã
repomix --include "src/**" --ignore "**/*.test.ts,**/__tests__/**" --output .repomix-output.md
```

### 1.2 ãƒˆãƒ¼ã‚¯ãƒ³æ•°ç¢ºèª

Repomixå‡ºåŠ›ã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã‚’ç¢ºèªã—ã€Geminiã®åˆ¶é™å†…ã‹æ¤œè¨¼:
- Gemini 2.0 Flash: 100ä¸‡ãƒˆãƒ¼ã‚¯ãƒ³
- Gemini 2.0 Pro: 200ä¸‡ãƒˆãƒ¼ã‚¯ãƒ³

```bash
# ãƒˆãƒ¼ã‚¯ãƒ³æ¦‚ç®—ï¼ˆ1ãƒˆãƒ¼ã‚¯ãƒ³ â‰ˆ 4æ–‡å­—ï¼‰
wc -c .repomix-output.md | awk '{print "Estimated tokens:", int($1/4)}'
```

---

## Phase 2: é™çš„åˆ†æï¼ˆCodexï¼‰

### 2.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†æ

```bash
codex "ä»¥ä¸‹ã®è¦³ç‚¹ã§ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚’åˆ†æã—ã¦JSONå½¢å¼ã§å‡ºåŠ›:
1. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆMVC, Clean Architectureç­‰ï¼‰
2. ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨è²¬å‹™
3. ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•
4. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
5. å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº
6. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
7. æŠ€è¡“çš„è² å‚µãƒ»æ”¹å–„ç‚¹" -f .repomix-output.md > .codex-analysis.json
```

### 2.2 åˆ†æçµæœã‚¹ã‚­ãƒ¼ãƒ

```json
{
  "architecture": {
    "pattern": "Clean Architecture",
    "layers": ["presentation", "application", "domain", "infrastructure"]
  },
  "components": [
    {"name": "UserService", "responsibility": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†", "dependencies": ["UserRepository"]}
  ],
  "dataFlow": {
    "entry": "API Gateway",
    "flow": ["Controller", "UseCase", "Repository", "Database"]
  },
  "externalServices": ["PostgreSQL", "Redis", "S3"],
  "techStack": {"language": "TypeScript", "framework": "Next.js"},
  "technicalDebt": ["éåº¦ãªanyä½¿ç”¨", "ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ä¸è¶³"]
}
```

---

## Phase 3: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆï¼ˆGeminiï¼‰

### 3.1 ç”Ÿæˆã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé¸æŠ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèª:
1. åŸºæœ¬è¨­è¨ˆæ›¸ã®ã¿
2. è©³ç´°è¨­è¨ˆæ›¸ã®ã¿
3. APIä»•æ§˜æ›¸ã®ã¿
4. å…¨ã¦ç”Ÿæˆ

### 3.2 Gemini APIå‘¼ã³å‡ºã—

```bash
# ç’°å¢ƒå¤‰æ•°ç¢ºèª
echo $GEMINI_API_KEY

# gemini-cli ã¾ãŸã¯ curl ã§å®Ÿè¡Œ
gemini -m gemini-2.0-flash \
  -s "$(cat ~/.claude/skills/doc-generator/prompts/gemini-generate.txt)" \
  -f .repomix-output.md \
  -f .codex-analysis.json \
  -f ~/.claude/skills/doc-generator/templates/basic-design.md
```

### 3.3 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆé †åº

1. **åŸºæœ¬è¨­è¨ˆæ›¸** - å…¨ä½“åƒã‚’æŠŠæ¡
2. **è©³ç´°è¨­è¨ˆæ›¸** - åŸºæœ¬è¨­è¨ˆã‚’å‚ç…§ã—ã¦è©³ç´°åŒ–
3. **APIä»•æ§˜æ›¸** - å®Ÿè£…è©³ç´°ã‚’åæ˜ 

---

## Phase 4: æ¤œè¨¼ãƒ»æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯

### 4.1 Codexã«ã‚ˆã‚‹æ¤œè¨¼

```bash
codex "ç”Ÿæˆã•ã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨å®Ÿã‚³ãƒ¼ãƒ‰ã®æ•´åˆæ€§ã‚’æ¤œè¨¼:
1. è¨˜è¼‰ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹/é–¢æ•°ãŒå®Ÿéš›ã«å­˜åœ¨ã™ã‚‹ã‹
2. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®è¨˜è¿°ãŒæ­£ç¢ºã‹
3. APIå®šç¾©ãŒå®Ÿè£…ã¨ä¸€è‡´ã™ã‚‹ã‹
4. æ¼ã‚Œã¦ã„ã‚‹é‡è¦ãªæ©Ÿèƒ½ã¯ãªã„ã‹

ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆ100ç‚¹æº€ç‚¹ï¼‰:
- æ­£ç¢ºæ€§: 40ç‚¹
- ç¶²ç¾…æ€§: 30ç‚¹
- æ•´åˆæ€§: 30ç‚¹" \
  -f .repomix-output.md \
  -f ./docs/generated-doc.md
```

### 4.2 åˆæ ¼åŸºæº–

| ã‚¹ã‚³ã‚¢ | åˆ¤å®š | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|--------|------|------------|
| 80ç‚¹ä»¥ä¸Š | âœ… åˆæ ¼ | æœ€çµ‚å‡ºåŠ›ã¸ |
| 60-79ç‚¹ | âš ï¸ è¦ä¿®æ­£ | Geminiã§å†ç”Ÿæˆ |
| 60ç‚¹æœªæº€ | âŒ ä¸åˆæ ¼ | æ‰‹å‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿…è¦ |

---

## Phase 5: å‡ºåŠ›ãƒ»ä¿å­˜

### 5.1 å‡ºåŠ›å…ˆ

```
docs/
â”œâ”€â”€ basic-design.md       # åŸºæœ¬è¨­è¨ˆæ›¸
â”œâ”€â”€ detailed-design.md    # è©³ç´°è¨­è¨ˆæ›¸
â”œâ”€â”€ api-spec.md           # APIä»•æ§˜æ›¸
â””â”€â”€ diagrams/
    â”œâ”€â”€ architecture.mmd  # Mermaidã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³
    â”œâ”€â”€ sequence.mmd      # ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³
    â””â”€â”€ er.mmd            # ERå›³
```

### 5.2 ç”Ÿæˆãƒ¬ãƒãƒ¼ãƒˆ

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“„ Doc Generator å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… ç”Ÿæˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:
   - docs/basic-design.md (2,450è¡Œ)
   - docs/detailed-design.md (4,120è¡Œ)
   - docs/api-spec.md (1,890è¡Œ)

ğŸ“Š æ¤œè¨¼ã‚¹ã‚³ã‚¢: 87/100
   - æ­£ç¢ºæ€§: 35/40
   - ç¶²ç¾…æ€§: 28/30
   - æ•´åˆæ€§: 24/30

â±ï¸ å‡¦ç†æ™‚é–“: 3åˆ†42ç§’
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## ã‚³ãƒãƒ³ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³

```bash
# åŸºæœ¬å®Ÿè¡Œ
/doc-generator

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¨®åˆ¥æŒ‡å®š
/doc-generator --type basic      # åŸºæœ¬è¨­è¨ˆæ›¸ã®ã¿
/doc-generator --type detailed   # è©³ç´°è¨­è¨ˆæ›¸ã®ã¿
/doc-generator --type api        # APIä»•æ§˜æ›¸ã®ã¿
/doc-generator --type all        # å…¨ã¦

# å¯¾è±¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæŒ‡å®š
/doc-generator --path src/

# å‡ºåŠ›å…ˆæŒ‡å®š
/doc-generator --output docs/design/

# Geminiãƒ¢ãƒ‡ãƒ«æŒ‡å®š
/doc-generator --model gemini-2.0-pro  # å¤§è¦æ¨¡ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹å‘ã‘
```

---

## å‰ææ¡ä»¶

### å¿…é ˆãƒ„ãƒ¼ãƒ«

```bash
# Repomix
npm install -g repomix

# Codex CLI
npm install -g @openai/codex

# Gemini CLIï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€APIã§ã‚‚å¯ï¼‰
pip install google-generativeai
```

### ç’°å¢ƒå¤‰æ•°

```bash
export GEMINI_API_KEY="your-api-key"
export OPENAI_API_KEY="your-api-key"  # Codexç”¨
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| å•é¡Œ | åŸå›  | è§£æ±ºç­– |
|------|------|--------|
| ãƒˆãƒ¼ã‚¯ãƒ³è¶…é | ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ãŒå¤§ãã™ãã‚‹ | `--include`ã§å¯¾è±¡ã‚’çµã‚‹ |
| ç”ŸæˆãŒä¸å®Œå…¨ | ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä¸è¶³ | Codexåˆ†æã‚’è©³ç´°åŒ– |
| æ•´åˆæ€§ã‚¹ã‚³ã‚¢ä½ã„ | å¤ã„æƒ…å ±ã®æ··å…¥ | Repomixå†å®Ÿè¡Œ |
| Geminiå¿œç­”ãªã— | ãƒ¬ãƒ¼ãƒˆåˆ¶é™ | å¾…æ©Ÿå¾Œãƒªãƒˆãƒ©ã‚¤ |

---

## Instructions

<doc-generator>
ã“ã®ã‚¹ã‚­ãƒ«ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã‚‰ã€ä»¥ä¸‹ã®æ‰‹é †ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š

### Step 1: ç’°å¢ƒç¢ºèª

1. **å¯¾è±¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç¢ºèª**
   - å¼•æ•°ã§ãƒ‘ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚Œã°ãã‚Œã‚’ä½¿ç”¨
   - ãªã‘ã‚Œã°ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¯¾è±¡

2. **å¿…é ˆãƒ„ãƒ¼ãƒ«ç¢ºèª**
   ```bash
   which repomix && which codex && echo "Tools OK"
   ```

3. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¨®åˆ¥ç¢ºèª**
   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªï¼ˆæŒ‡å®šãŒãªã‘ã‚Œã°ï¼‰:
   - basic: åŸºæœ¬è¨­è¨ˆæ›¸
   - detailed: è©³ç´°è¨­è¨ˆæ›¸
   - api: APIä»•æ§˜æ›¸
   - all: å…¨ã¦ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰

### Step 2: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåé›†ï¼ˆRepomixï¼‰

```bash
# src/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¯¾è±¡ã«Repomixå®Ÿè¡Œ
repomix --include "src/**" --ignore "**/*.test.ts,**/__tests__/**,**/node_modules/**" --output .repomix-output.md

# ãƒˆãƒ¼ã‚¯ãƒ³æ•°ç¢ºèª
wc -c .repomix-output.md | awk '{print "Estimated tokens:", int($1/4)}'
```

- 100ä¸‡ãƒˆãƒ¼ã‚¯ãƒ³è¶…ã®å ´åˆã¯å¯¾è±¡ã‚’çµã‚‹ã‚ˆã†è­¦å‘Š

### Step 3: é™çš„åˆ†æï¼ˆCodexï¼‰

```bash
codex "$(cat ~/.claude/skills/doc-generator/prompts/codex-analysis.txt)" -f .repomix-output.md > .codex-analysis.json
```

- åˆ†æçµæœã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¦‚è¦å ±å‘Š

### Step 4: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆï¼ˆGeminiï¼‰

Gemini APIã‚’ä½¿ç”¨ã—ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ:

1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã¿
2. åˆ†æçµæœã¨ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚’å…¥åŠ›
3. æŒ‡å®šã•ã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¨®åˆ¥ã‚’ç”Ÿæˆ

```bash
# åŸºæœ¬è¨­è¨ˆæ›¸ã®å ´åˆ
gemini -m gemini-2.0-flash \
  -s "$(cat ~/.claude/skills/doc-generator/prompts/gemini-generate.txt)" \
  -f .repomix-output.md \
  -f .codex-analysis.json \
  -f ~/.claude/skills/doc-generator/templates/basic-design.md \
  > docs/basic-design.md
```

### Step 5: æ¤œè¨¼ï¼ˆCodexï¼‰

```bash
codex "ç”Ÿæˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨å®Ÿã‚³ãƒ¼ãƒ‰ã®æ•´åˆæ€§ã‚’æ¤œè¨¼ã€‚ã‚¹ã‚³ã‚¢ï¼ˆ100ç‚¹æº€ç‚¹ï¼‰ã§è©•ä¾¡: æ­£ç¢ºæ€§40ç‚¹ã€ç¶²ç¾…æ€§30ç‚¹ã€æ•´åˆæ€§30ç‚¹" \
  -f .repomix-output.md \
  -f docs/basic-design.md
```

- 80ç‚¹ä»¥ä¸Š: å®Œäº†
- 80ç‚¹æœªæº€: å•é¡Œç‚¹ã‚’ä¿®æ­£ã—ã¦å†ç”Ÿæˆ

### Step 6: å®Œäº†å ±å‘Š

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“„ Doc Generator å®Œäº†
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… ç”Ÿæˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:
   - docs/basic-design.md
   - docs/detailed-design.md
   - docs/api-spec.md

ğŸ“Š æ¤œè¨¼ã‚¹ã‚³ã‚¢: XX/100

â±ï¸ å‡¦ç†æ™‚é–“: Xåˆ†Xç§’
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### æ³¨æ„äº‹é …

- Gemini APIã‚­ãƒ¼ãŒãªã„å ´åˆã¯Claudeã§ä»£æ›¿ç”Ÿæˆ
- CodexãŒãªã„å ´åˆã¯Claudeã§åˆ†æ
- å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯æ®µéšçš„ã«å‡¦ç†
- ç”Ÿæˆå¾Œã®ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.repomix-output.md, .codex-analysis.jsonï¼‰ã¯ä¿æŒ

</doc-generator>
